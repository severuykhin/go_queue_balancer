### Запуск консьюмера
Чтобы запустить консьюмера необходимо выполнить команду  
```
CONSUMER_ID=1 \
STREAM_NAME=BOTS \
MONITOR_STREAM_NAME=BOTS_MONITOR \
REDIS_ACCOUNTS_LIMITS_DB=1 \
REDIS_HOST=localhost:6379 \
REDIS_PASSWORD=simple \
go run cmd/main/main.go

```

### Типы сообщений

Тип сообщения приходит в заголовке `type`  
Далее в зависимости от типа парсится структура сообщения и передается в соответствубщий метод  

```
Headers:
type: declare_queue

{
    group_id: 1
}

```

Вопрос - при пендинге все такие есть некая задержка



1. Проблема 1 со сравнением текущего количества выполненных операций с количеством доступных операций
Решение:
Декрементным счетчиком - на начало новых суток имеем количество доступных действий для аккаунта в отдельном счетчике и постепенно его уменьшаем - наверно лучший способ, чтобы использовать этот счетчик централизовано из разных компонент и подсистем

2. Проблема 2 - зачем нам поднимать консьюмеры для сообществ при старте, если будет дублирующий стрим, через который мы можем контролировать поток событий и консьюмеры? То есть поднять общий консьюмер - он подхватит сообщения и выполнит соответствующие действия

3. Проблема 3 - как разбудить консьюмер сообщества после остановки при превышении суточного лимита?
Например - консьюмер определеного сообщества обрабатывает сообщения. В какой-то момент лимит превышается и консьюмер автоматически останавливается. В этот момент основной консьюмер, который обрабатывает "дублирующий" стрим продолжает читать сообщения и ничего не знает о лимитах, видит, что сообщества, которому принадлежит очередное сообщение, нет консьюмера и запускает консьюмер по новой. А на одном аккаунте таких сообществ может быть несколько (прим: Свою люди, ДодоПицца)
Решения:
- Оставить все как есть - но на каждое такое сообщение будет подыматься и тут же останавливаться горутина а сообщение будет через Nack уходить в стрим повторно
- Основной консьюмер тоже должен знать о лимитах